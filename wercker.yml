box: python:2.7

build:
    steps:
        - virtualenv


build:
    steps:
        - pip-install

build:
    steps:
        - install-packages:
            packages: openssh-client


        - script:
                name: Enable virtual display
                code: |
                  python --version
                  export DISPLAY=:99.0
                  #start-stop-daemon --start --quiet --pidfile /tmp/xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -screen 0 1024x768x24 -ac +extension GLX +render -noreset
                  sudo start-stop-daemon --start --quiet --pidfile /tmp/firefox_99.pid --make-pidfile --background --exec /usr/bin/firefox -- :99 -screen 0 1024x768x24 -ac +extension GLX +render -noreset
        - script:
                name: python unit test
                code: |
                  python --version
                  pip install -r requirements.txt
                  pip list
                  python manage.py test
